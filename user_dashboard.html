<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VendorHive - User Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <!-- <style>
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      margin: 0;
      background: #f5f5f5;
      color: #333;
    }

    header {
      background: #6c63ff;
      color: white;
      padding: 1rem;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
    }

    .counts, .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      align-items: center;
    }

    .counts span {
      background: white;
      color: #6c63ff;
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      font-weight: bold;
    }

    select {
      padding: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    button.logout-btn {
      background: #ffffff;
      color: #6c63ff;
      padding: 6px 12px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }

    #userProductList {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      padding: 1rem;
    }

    .product-card {
      background: #fefefe;
      border-radius: 10px;
      padding: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.08);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 100%;
    }

    .product-card img {
      width: 100%;
      height: 200px;
      object-fit: contain;
      border-radius: 10px;
      margin-bottom: 1rem;
    }

    .product-card h3 {
      font-size: 1.1rem;
      margin-bottom: 0.3rem;
    }

    .product-card p {
      font-size: 0.9rem;
      color: #555;
      margin: 0.3rem 0;
    }

    .buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn {
      flex: 1;
      padding: 0.5rem;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .add-cart-btn { background-color: #10b981; color: white; }
    .add-cart-btn:hover { background-color: #059669; }

    .wishlist-btn { background-color: #3b82f6; color: white; }
    .wishlist-btn:hover { background-color: #2563eb; }

    .remove-btn { background-color: #e74c3c; color: white; }
    .remove-btn:hover { background-color: #c0392b; }

    .checkout-screen {
      position: fixed;
      top: 0;
      right: 0;
      width: 360px;
      height: 100vh;
      background: #fff;
      box-shadow: -3px 0 12px rgba(0,0,0,0.2);
      padding: 1rem;
      overflow-y: auto;
      z-index: 1000;
      display: none;
    }

    .dark { background-color: #121212; color: #eee; }
    .dark header { background: #1f1f40; }
    .dark .product-card { background: #1e1e2e; color: #f1f1f1; }


     .footer {
      background-color: #1e293b;
      color: #f1f5f9;
      padding: 50px 20px 20px;
      font-size: 14px;
      margin-top: auto;
    }

    .footer-grid {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: 32px;
  max-width: 1200px;
  margin: 0 auto 30px;
  padding: 0 10px;
}
.footer-col {
  flex: 1 1 220px;
  min-width: 180px;
}
    .footer h4 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 16px;
      color: #fbbf24;
    }

    .footer ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .footer ul li {
      margin-bottom: 10px;
      word-wrap: break-word;
       transition: color 0.3s ease;
    }

    .footer ul li a {
      text-decoration: none;
      color: #cbd5e1;
      transition: color 0.3s ease;
    }

    .footer ul li a:hover {
      color: #ffffff;
    }

    .footer hr {
      border: 0;
      border-top: 1px solid #334155;
      margin-bottom: 20px;
    }

    .footer-bottom {
      text-align: center;
      color: #94a3b8;
        padding: 10px;
    }

    .footer-bottom .heart {
      color: #f43f5e;
    }

    @media (max-width: 600px) {
  .footer-col {
    flex: 1 1 100%;
  }
}
  </style> -->

<style>
  * {
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  body {
    margin: 0;
    background: #f9fafb;
    color: #1f2937;
  }

  header {
    background: #1f2937;
    color: #f9fafb;
    padding: 1rem;
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
  }

  .counts, .filters {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: center;
  }

  .counts span {
    background: #fff;
    color: #6366f1;
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    font-weight: bold;
  }

  select {
    padding: 6px 10px;
    border-radius: 6px;
    border: 1px solid #d1d5db;
    background: white;
    font-weight: 500;
  }

  button.logout-btn {
    background: #6366f1;
    color: white;
    padding: 6px 14px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    font-weight: bold;
  }

  button.logout-btn:hover {
    background-color: #4f46e5;
  }

  #userProductList {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 1.5rem;
    padding: 2rem;
  }

  .product-card {
    background: #ffffff;
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    transition: transform 0.2s ease;
  }

  .product-card:hover {
    transform: translateY(-4px);
  }

  .product-card img {
    width: 100%;
    height: 200px;
    object-fit: contain;
    border-radius: 10px;
    margin-bottom: 1rem;
    background: #f3f4f6;
  }

  .product-card h3 {
    font-size: 1.1rem;
    margin-bottom: 0.3rem;
    color: #111827;
  }

  .product-card p {
    font-size: 0.9rem;
    color: #4b5563;
    margin: 0.3rem 0;
  }

  .buttons {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-top: 0.5rem;
  }

  .btn {
    flex: 1;
    padding: 0.5rem;
    font-weight: bold;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s ease;
  }

  .add-cart-btn {
    background-color: #10b981;
    color: white;
  }

  .add-cart-btn:hover {
    background-color: #059669;
  }

  .wishlist-btn {
    background-color: #6366f1;
    color: white;
  }

  .wishlist-btn:hover {
    background-color: #4f46e5;
  }

  .remove-btn {
    background-color: #ef4444;
    color: white;
  }

  .remove-btn:hover {
    background-color: #dc2626;
  }

  .checkout-screen {
    position: fixed;
    top: 0;
    right: 0;
    width: 360px;
    height: 100vh;
    background: #ffffff;
    box-shadow: -3px 0 12px rgba(0,0,0,0.1);
    padding: 1.5rem;
    overflow-y: auto;
    z-index: 1000;
    display: none;
  }

  .dark {
    background-color: #111827;
    color: #f3f4f6;
  }

  .dark header {
    background: #0f172a;
  }

  .dark .product-card {
    background: #1f2937;
    color: #f9fafb;
  }

  /* Footer styling */
  .footer {
    background-color: #1e293b;
    color: #f1f5f9;
    padding: 50px 20px 20px;
    font-size: 14px;
    margin-top: auto;
  }

  .footer-grid {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    gap: 32px;
    max-width: 1200px;
    margin: 0 auto 30px;
    padding: 0 10px;
  }

  .footer-col {
    flex: 1 1 220px;
    min-width: 180px;
  }

  .footer h4 {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 16px;
    color: #facc15;
  }

  .footer ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .footer ul li {
    margin-bottom: 10px;
    word-wrap: break-word;
    transition: color 0.3s ease;
  }

  .footer ul li a {
    text-decoration: none;
    color: #cbd5e1;
    transition: color 0.3s ease;
  }

  .footer ul li a:hover {
    color: #ffffff;
  }

  .footer hr {
    border: 0;
    border-top: 1px solid #334155;
    margin-bottom: 20px;
  }

  .footer-bottom {
    text-align: center;
    color: #94a3b8;
    padding: 10px;
  }

  .footer-bottom .heart {
    color: #f43f5e;
  }

  @media (max-width: 600px) {
    .footer-col {
      flex: 1 1 100%;
    }
  }
</style>

</head>
<body>
  <header>
    <h2>üõí VendorHive - Shop</h2>
    <div class="filters">
      <select id="categoryFilter"><option value="">All Categories</option></select>
      <select id="sortFilter">
        <option value="">Sort</option>
        <option value="priceLow">Price: Low to High</option>
        <option value="priceHigh">Price: High to Low</option>
      </select>
      <button class="logout-btn" onclick="logoutUser()">Logout</button>
    </div>
    <button class="logout-btn" onclick="toggleDarkMode()">üåì Dark Mode</button>
    <div class="counts">
      <span id="cartCount">üõçÔ∏è Cart: 0</span>
      <span id="wishlistCount">‚ù§Ô∏è Wishlist: 0</span>
      <button class="logout-btn" onclick="showCheckout()">Checkout</button>
      <button class="logout-btn" onclick="showWishlist()">Wishlist</button>
    </div>
  </header>

  <section id="userProductList"></section>

  <div class="checkout-screen" id="checkoutScreen">
    <h3>üßæ Your Cart</h3>
    <div id="checkoutItems"></div>
    <p><strong>Total: ‚Çπ<span id="checkoutTotal">0</span></strong></p>
    <button onclick="placeOrder()">üì¶ Place Order</button>
    <button onclick="hideCheckout()">‚ùå Close</button>
  </div>

  <div class="checkout-screen" id="wishlistScreen">
    <h3>üíñ Your Wishlist</h3>
    <div id="wishlistItems"></div>
    <button onclick="hideWishlist()">‚ùå Close</button>
  </div>

  
  <!-- ‚úÖ Footer -->
  <footer class="footer">
    <div class="footer-grid">
      <div class="footer-col">
        <h4>For Customers</h4>
        <ul>
          <li><a href="#">How to Shop</a></li>
          <li><a href="#">Customer Support</a></li>
          <li><a href="#">Return Policy</a></li>
          <li><a href="#">Safety & Security</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>For Businesses</h4>
        <ul>
          <li><a href="#">Sell on VendorHive</a></li>
          <li><a href="#">Business Resources</a></li>
          <li><a href="#">Pricing Plans</a></li>
          <li><a href="#">Success Stories</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>Company</h4>
        <ul>
          <li><a href="#">About Us</a></li>
          <li><a href="#">Careers</a></li>
          <li><a href="#">Press</a></li>
          <li><a href="#">Community Impact</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>Support</h4>
        <ul>
          <li><a href="#">Help Center</a></li>
          <li><a href="#">Contact Us</a></li>
          <li><a href="#">Terms of Service</a></li>
          <li><a href="#">Privacy Policy</a></li>
        </ul>
      </div>
    </div>
    <hr />
    <div class="footer-bottom">
      ¬© 2025 VendorHive. All rights reserved. Built with <span class="heart">‚ù§Ô∏è</span> for local communities.
    </div>
  </footer>
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-auth-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDyZt2GkKP-xZu1fnGfStPyWLvM5oWjm9Q",
      authDomain: "ecommerce-396a5.firebaseapp.com",
      databaseURL: "https://ecommerce-396a5-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "ecommerce-396a5",
      storageBucket: "ecommerce-396a5.appspot.com",
      messagingSenderId: "292220509400",
      appId: "1:292220509400:web:50a603a5f82f3402784bad"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();

    let products = {}, cart = {}, wishlist = {};
    const productList = document.getElementById("userProductList");
    const categoryFilter = document.getElementById("categoryFilter");
    const sortFilter = document.getElementById("sortFilter");

    function updateCounts() {
      document.getElementById("cartCount").textContent = `üõçÔ∏è Cart: ${Object.keys(cart).length}`;
      document.getElementById("wishlistCount").textContent = `‚ù§Ô∏è Wishlist: ${Object.keys(wishlist).length}`;
    }

    function syncCart() {
      const uid = auth.currentUser?.uid;
      if (uid) {
        db.ref("carts/" + uid).set(cart);
        db.ref("wishlists/" + uid).set(wishlist);
      }
    }

    function renderProducts(category = "", sort = "") {
      productList.innerHTML = "";
      let items = Object.entries(products);

      if (category) items = items.filter(([_, p]) => p.category === category);
      if (sort === "priceLow") items.sort((a,b) => a[1].price - b[1].price);
      if (sort === "priceHigh") items.sort((a,b) => b[1].price - a[1].price);

      for (let [id, p] of items) {
        const card = document.createElement("div");
        card.className = "product-card";
        card.innerHTML = `
          <img src="${p.imageURL}" />
          <h3>${p.title}</h3>
          <p>${p.description}</p>
          <p><strong>‚Çπ${p.price}</strong> (${p.discount || 0}% OFF)</p>
          <p>Rating: ${p.rating || 'No rating'}</p>
          <div class="buttons">
            <button class="btn add-cart-btn" onclick="addToCart('${id}')">Add to Cart</button>
            <button class="btn remove-btn" onclick="removeFromCart('${id}')">Remove Cart</button>
            <button class="btn wishlist-btn" onclick="addToWishlist('${id}')">Add to Wishlist</button>
            <button class="btn remove-btn" onclick="removeFromWishlist('${id}')">Remove Wishlist</button>
          </div>
        `;
        productList.appendChild(card);
      }
    }

    function showCheckout() {
      const screen = document.getElementById("checkoutScreen");
      const items = document.getElementById("checkoutItems");
      let total = 0;
      items.innerHTML = "";

      for (let id in cart) {
        const p = products[id];
        const qty = cart[id];
        const price = parseFloat(p.price);
        total += price * qty;
        const div = document.createElement("div");
        div.innerHTML = `<p><strong>${p.title}</strong> √ó ${qty} = ‚Çπ${qty * price}</p>`;
        items.appendChild(div);
      }
      document.getElementById("checkoutTotal").textContent = total;
      screen.style.display = 'block';
    }

    function hideCheckout() {
      document.getElementById("checkoutScreen").style.display = 'none';
    }

    function showWishlist() {
      const screen = document.getElementById("wishlistScreen");
      const items = document.getElementById("wishlistItems");
      items.innerHTML = "";

      for (let id in wishlist) {
        const p = products[id];
        const div = document.createElement("div");
        div.innerHTML = `<p>‚ù§Ô∏è ${p.title}</p>`;
        items.appendChild(div);
      }
      screen.style.display = 'block';
    }

    function hideWishlist() {
      document.getElementById("wishlistScreen").style.display = 'none';
    }
    function placeOrder() {
      const uid = auth.currentUser?.uid;
      const timestamp = Date.now();

      for (let id in cart) {
        const p = products[id];
        const sellerId = p.sellerId || 'admin';
        db.ref(`orders/${sellerId}`).push({
          userId: uid,
          productId: id,
          quantity: cart[id],
          title: p.title,
          price: p.price,
          timestamp
        });
      }

      cart = {};
      updateCounts();
      syncCart();
      hideCheckout();
      alert("‚úÖ Order Placed!");
    }

    function addToCart(id) {
      cart[id] = (cart[id] || 0) + 1;
      updateCounts(); syncCart();
    }

    function removeFromCart(id) {
      delete cart[id];
      updateCounts(); syncCart();
    }

    function addToWishlist(id) {
      wishlist[id] = true;
      updateCounts(); syncCart();
    }

    function removeFromWishlist(id) {
      delete wishlist[id];
      updateCounts(); syncCart();
    }

    function logoutUser() {
      auth.signOut().then(() => window.location.href = "index.html");
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark");
    }

    db.ref("products").on("value", snapshot => {
      products = snapshot.val() || {};
      const categories = new Set(Object.values(products).map(p => p.category).filter(Boolean));
      categoryFilter.innerHTML = `<option value="">All Categories</option>` +
        [...categories].map(c => `<option value="${c}">${c}</option>`).join('');
      renderProducts();
    });

    categoryFilter.addEventListener("change", () => renderProducts(categoryFilter.value, sortFilter.value));
    sortFilter.addEventListener("change", () => renderProducts(categoryFilter.value, sortFilter.value));

    auth.onAuthStateChanged(user => {
      if (!user) {
        window.location.href = "index.html";
      } else {
        const uid = user.uid;
        db.ref("carts/" + uid).once("value", snap => cart = snap.val() || {});
        db.ref("wishlists/" + uid).once("value", snap => wishlist = snap.val() || {});
        updateCounts();
      }
    });
  </script>
</body>
</html>
